<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TAURUS ADMIN (Emergency Fix)</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
    .control-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 10px; }
    .btn { padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; border: 1px solid #ccc; font-size: 14px; }
    .btn-hit { background: #ffebee; color: #c62828; border-color: #ef9a9a; }
    .btn-out { background: #eceff1; color: #455a64; border-color: #b0bec5; }
    .btn-adv { background: #e8f5e9; color: #2e7d32; border-color: #a5d6a7; }
    
    /* ì‹œë‚˜ë¦¬ì˜¤ ëª¨ë‹¬ */
    .scenario-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 9999; display: none; align-items: center; justify-content: center; }
    .sm-box { background: #fff; width: 95%; max-width: 400px; padding: 20px; border-radius: 12px; text-align: center; }
    .field-editor { position: relative; height: 160px; background: #2e7d32; border-radius: 8px; margin: 15px 0; border: 2px solid #fff; }
    .base-chk { position: absolute; width: 35px; height: 35px; background: #fff; transform: rotate(45deg); cursor: pointer; border: 2px solid #ccc; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; }
    .base-chk.checked { background: #ffeb3b; border-color: #fbc02d; box-shadow: 0 0 8px #ffeb3b; }
    .base-chk span { transform: rotate(-45deg); }
    .bc-1 { right: 20px; top: 60px; } .bc-2 { left: 50%; top: 10px; margin-left: -17.5px; } .bc-3 { left: 20px; top: 60px; }
    
    .score-control { display: flex; justify-content: center; align-items: center; gap: 15px; margin: 15px 0; background: #f5f5f5; padding: 10px; border-radius: 8px; }
    .score-btn { width: 30px; height: 30px; border-radius: 50%; border: none; background: #333; color: #fff; font-size: 18px; cursor: pointer; }
    .confirm-btn { width: 100%; padding: 15px; background: #1976d2; color: #fff; font-size: 16px; font-weight: bold; border: none; border-radius: 8px; cursor: pointer; }
    
    .opt-group { display: flex; gap: 5px; margin-bottom: 10px; justify-content: center; }
    .opt-btn { flex: 1; padding: 10px; font-size: 12px; border: 1px solid #ddd; background: #fff; cursor: pointer; }
    .opt-btn.selected { background: #333; color: #fff; border-color: #000; }

    .info-bar { background: #333; color: #fff; padding: 10px; margin-bottom: 10px; font-size: 14px; display: flex; justify-content: space-between; }
  </style>
</head>
<body>

  <div id="loginLayer" class="admin-login-overlay">
    <h2>âš¾ TAURUS ADMIN</h2>
    <input type="password" id="adminPw" placeholder="ë¹„ë°€ë²ˆí˜¸ (taurus)" style="padding:10px; margin:10px;">
    <button id="loginBtn" style="padding:10px 20px;">ì ‘ì†</button>
  </div>

  <div id="adminPanel" style="display:none; max-width: 600px; margin: 0 auto;">
    
    <div id="setupView" style="padding:20px; background:#fff;">
      <h3>ğŸ› ï¸ ê²½ê¸° ì„¤ì •</h3>
      <div style="background:#e3f2fd; padding:10px; border-radius:8px; margin-bottom:15px; text-align:center;">
        <button id="loadScheduleBtn" class="btn" style="width:100%; background:#2196f3; color:#fff; border:none;">ğŸ“… ì˜¤ëŠ˜ ìŠ¤ì¼€ì¤„ ë¶ˆëŸ¬ì˜¤ê¸°</button>
        <div id="scheduleMsg" style="font-size:12px; margin-top:5px; color:#0d47a1;"></div>
      </div>
      
      <div style="display:flex; gap:10px;">
        <div style="flex:1">
          <input type="text" id="awayName" placeholder="ì›ì •íŒ€" value="TAURUS" style="width:100%; text-align:center; font-weight:bold;">
          <div id="awayLineup"></div>
        </div>
        <div style="flex:1">
          <input type="text" id="homeName" placeholder="í™ˆíŒ€" style="width:100%; text-align:center; font-weight:bold;">
          <div id="homeLineup"></div>
        </div>
      </div>
      <div style="margin-top:10px; text-align:center;">
        <label><input type="radio" name="firstAttack" value="away" checked> ì›ì • ì„ ê³µ</label>
        <label><input type="radio" name="firstAttack" value="home"> í™ˆ ì„ ê³µ</label>
      </div>
      <button id="startBtn" class="btn" style="width:100%; background:#2e7d32; color:#fff; margin-top:15px;">ê²½ê¸° ì‹œì‘ (PLAY BALL)</button>
    </div>

    <div id="gameView" style="display:none;">
      <div class="info-bar">
        <span><span id="d_away">AWAY</span> <span id="s_away" style="font-weight:bold; font-size:18px;">0</span></span>
        <span id="d_inn">1íšŒì´ˆ</span>
        <span><span id="s_home" style="font-weight:bold; font-size:18px;">0</span> <span id="d_home">HOME</span></span>
      </div>
      
      <div style="background:#fff; padding:10px; margin-bottom:10px; border-bottom:1px solid #ddd;">
        <div style="text-align:center; font-size:18px; font-weight:bold; margin-bottom:5px;">
          <span style="color:green">B <span id="cnt_b">0</span></span>
          <span style="color:#fbc02d">S <span id="cnt_s">0</span></span>
          <span style="color:red">O <span id="cnt_o">0</span></span>
        </div>
        <div style="text-align:center; font-size:12px; color:#555;">
          íˆ¬ìˆ˜: <span id="cur_pit">-</span> (Total:<span id="pit_t">0</span> / S:<span id="pit_s">0</span> B:<span id="pit_b">0</span>)
        </div>
        <div style="text-align:center; font-size:14px; margin-top:5px;">
          íƒ€ì„: <span id="cur_bat" style="color:#1976d2; font-weight:bold;">-</span>
        </div>
      </div>

      <div style="padding:10px;">
        <h4 style="margin:0 0 5px 0;">íˆ¬êµ¬ (ì‹¤ì‹œê°„ ì•Œë¦¼)</h4>
        <div class="control-grid">
          <button class="btn btn-out" onclick="addBallCount('b')">ë³¼</button>
          <button class="btn btn-out" onclick="addBallCount('s')">ìŠ¤íŠ¸ë¼ì´í¬</button>
          <button class="btn btn-out" onclick="addBallCount('f')">íŒŒìš¸</button>
          <button class="btn btn-out" style="background:#333; color:#fff;" onclick="resetBSO()">BSO ë¦¬ì…‹</button>
        </div>

        <h4 style="margin:10px 0 5px 0;">íƒ€ê²© ê²°ê³¼ (í¸ì§‘ê¸° ì‹¤í–‰)</h4>
        <div class="control-grid">
          <button class="btn btn-hit" onclick="openScenario('hit', 1)">ì•ˆíƒ€</button>
          <button class="btn btn-hit" onclick="openScenario('hit', 2)">2ë£¨íƒ€</button>
          <button class="btn btn-hit" onclick="openScenario('hit', 3)">3ë£¨íƒ€</button>
          <button class="btn btn-hit" onclick="openScenario('hr', 4)">í™ˆëŸ°</button>
          
          <button class="btn btn-out" onclick="openScenario('out', 'go')">ë•…ë³¼</button>
          <button class="btn btn-out" onclick="openScenario('out', 'fo')">ëœ¬ê³µ</button>
          <button class="btn btn-out" onclick="openScenario('k', 'so')">ì‚¼ì§„</button>
          <button class="btn btn-out" onclick="openScenario('out', 'dp')">ë³‘ì‚´</button>
          
          <button class="btn btn-adv" onclick="openScenario('4ball', 'bb')">ë³¼ë„·</button>
          <button class="btn btn-adv" onclick="openScenario('4ball', 'hbp')">ì‚¬êµ¬</button>
          <button class="btn btn-adv" onclick="openScenario('err', 'err')">ì‹¤ì±…</button>
          <button class="btn btn-adv" onclick="openScenario('etc', 'fc')">ì•¼ì„ </button>
        </div>
        
        <div style="margin-top:20px; display:flex; gap:10px;">
           <button class="btn" style="flex:1;" onclick="changeBatter()">ëŒ€íƒ€</button>
           <button class="btn" style="flex:1;" onclick="changePitcher()">íˆ¬ìˆ˜êµì²´</button>
           <button class="btn" style="flex:1; background:#333; color:#fff;" onclick="endGame()">ê²½ê¸° ì¢…ë£Œ</button>
        </div>
      </div>
    </div>
  </div>

  <div id="scenarioModal" class="scenario-modal">
    <div class="sm-box">
      <h3 id="smTitle" style="margin-top:0;">ê²°ê³¼ í™•ì •</h3>
      
      <div id="hitLocBox" class="opt-group" style="display:none;">
        <button class="opt-btn" onclick="selLoc(this, 'ì¢Œì „')">ì¢Œì¸¡</button>
        <button class="opt-btn" onclick="selLoc(this, 'ì¤‘ì „')">ì¤‘ì•™</button>
        <button class="opt-btn" onclick="selLoc(this, 'ìš°ì „')">ìš°ì¸¡</button>
        <button class="opt-btn" onclick="selLoc(this, 'ë‚´ì•¼')">ë‚´ì•¼</button>
      </div>

      <p style="font-size:12px; color:#666;">â–¼ ìµœì¢… ì£¼ì ìœ„ì¹˜ë¥¼ ì²´í¬í•˜ì„¸ìš”</p>
      <div class="field-editor">
        <div id="chk3" class="base-chk bc-3" onclick="toggleBase(3)"><span>3</span></div>
        <div id="chk2" class="base-chk bc-2" onclick="toggleBase(2)"><span>2</span></div>
        <div id="chk1" class="base-chk bc-1" onclick="toggleBase(1)"><span>1</span></div>
      </div>

      <div class="score-control">
        <span style="font-weight:bold;">ì¶”ê°€ ë“ì :</span>
        <button class="score-btn" onclick="adjScore(-1)">-</button>
        <span id="scoreInput" style="font-size:24px; font-weight:bold; width:30px;">0</span>
        <button class="score-btn" onclick="adjScore(1)">+</button>
      </div>

      <button class="confirm-btn" onclick="submitScenario()">ì „ì†¡</button>
      <button onclick="closeScenario()" style="margin-top:10px; background:none; border:none; color:#666; cursor:pointer;">ì·¨ì†Œ</button>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getDatabase, ref, set, push, update, onValue } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDMVkogwvzoQon3lo0_hiVewfoXxmvbYMU",
      authDomain: "taurus-cbnu.firebaseapp.com",
      databaseURL: "https://taurus-cbnu-default-rtdb.firebaseio.com",
      projectId: "taurus-cbnu",
      storageBucket: "taurus-cbnu.firebasestorage.app",
      messagingSenderId: "598393475132",
      appId: "1:598393475132:web:b266ef01509e6c20dd7339"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    let game = {
      teams: { away:'', home:'' }, inn: '1íšŒì´ˆ', top: true,
      score: { away:0, home:0 }, bso: {b:0, s:0, o:0},
      runner: { b1: false, b2: false, b3: false },
      lineups: { away:[], home:[] },
      pitchers: { away:{name:'',total:0,s:0,b:0}, home:{name:'',total:0,s:0,b:0} },
      idx: { away:0, home:0 },
      lastPlay: ''
    };
    
    let tempScenario = { type: '', detail: '', runs: 0, runners: [false,false,false], loc: '' };

    document.addEventListener('DOMContentLoaded', () => {
      const makeInputs = (id, p) => {
        const d = document.getElementById(id); d.innerHTML='';
        for(let i=0; i<9; i++) d.innerHTML+=`<input id="${p}${i}" placeholder="${i+1}ë²ˆ" style="width:100%; margin:2px 0; padding:4px;">`;
      };
      makeInputs('awayLineup', 'a'); makeInputs('homeLineup', 'h');

      document.getElementById('loginBtn').onclick = () => {
        if(document.getElementById('adminPw').value==='taurus') {
          document.getElementById('loginLayer').style.display='none';
          document.getElementById('adminPanel').style.display='block';
        } else alert('ë¹„ë²ˆ ì˜¤ë¥˜');
      };

      // â˜… ë‚ ì§œ ì¸ì‹ ê°œì„ ëœ ìŠ¤ì¼€ì¤„ ë¶ˆëŸ¬ì˜¤ê¸° ë¡œì§
      document.getElementById('loadScheduleBtn').onclick = async () => {
        try {
          const btn = document.getElementById('loadScheduleBtn');
          const msg = document.getElementById('scheduleMsg');
          btn.textContent = "ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...";
          
          const res = await fetch('schedule.json?t='+Date.now());
          const data = await res.json();
          const today = new Date(); // í˜„ì¬ ì‹œê°„
          
          let found = null;
          
          // ëª¨ë“  ì—°ë„, ëª¨ë“  ê²½ê¸° ê²€ìƒ‰
          Object.values(data).flat().forEach(g => {
             // 1. ë‚ ì§œ ë¬¸ìì—´ ì •ê·œí™” (ì , í•˜ì´í”ˆ ëª¨ë‘ ìŠ¬ë˜ì‹œë¡œ í†µì¼)
             let dStr = g.date.replace(/[-.]/g, '/');
             let gDate = new Date(dStr);
             
             // ì—°ë„ê°€ ì—†ìœ¼ë©´ ì˜¬í•´ ì—°ë„ ë¶™ì—¬ì„œ ì¬ì‹œë„
             if(dStr.split('/').length < 3) {
                 gDate = new Date(`${today.getFullYear()}/${dStr}`);
             }

             // 2. ë‚ ì§œ ë¹„êµ (ë…„/ì›”/ì¼ë§Œ ë¹„êµ)
             if (gDate.getFullYear() === today.getFullYear() &&
                 gDate.getMonth() === today.getMonth() &&
                 gDate.getDate() === today.getDate()) {
                 found = g;
             }
          });
          
          if(found) {
             msg.textContent = `âœ… ê²½ê¸° ë°œê²¬! ${found.time} vs ${found.opponent}`;
             document.getElementById('awayName').value = 'TAURUS';
             document.getElementById('homeName').value = found.opponent;
             
             // í™ˆ/ì–´ì›¨ì´ ìë™ ì²´í¬
             if(found.location && (found.location.includes('ì²­ì£¼') || found.location.includes('ë³¸êµ'))) {
                 document.querySelectorAll('input[name="firstAttack"]')[1].checked = true; // í™ˆ ì„ ê³µ(ë§ê³µê²©)
             }
          } else {
             msg.textContent = "âš ï¸ ì˜¤ëŠ˜ ë‚ ì§œ ê²½ê¸°ê°€ ìŠ¤ì¼€ì¤„ì— ì—†ìŠµë‹ˆë‹¤. ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.";
          }
          btn.textContent = "ğŸ“… ì˜¤ëŠ˜ ìŠ¤ì¼€ì¤„ ë¶ˆëŸ¬ì˜¤ê¸°";
        } catch(e) { 
            alert('ìŠ¤ì¼€ì¤„ íŒŒì¼ ì½ê¸° ì‹¤íŒ¨'); 
            document.getElementById('loadScheduleBtn').textContent = "ğŸ“… ì˜¤ëŠ˜ ìŠ¤ì¼€ì¤„ ë¶ˆëŸ¬ì˜¤ê¸°";
        }
      };

      document.getElementById('startBtn').onclick = () => {
        const away = document.getElementById('awayName').value;
        const home = document.getElementById('homeName').value;
        const isAwayFirst = document.querySelector('input[name="firstAttack"]:checked').value === 'away';
        
        const getLineup = (p) => {
          let arr = [];
          for(let i=0; i<9; i++) arr.push({
             name: document.getElementById(p+i).value || `íƒ€ì${i+1}`,
             pa:0, ab:0, h:0, bb:0, k:0, r:0, rbi:0 
          });
          return arr;
        };

        game = {
          teams: { away, home },
          inn: '1íšŒì´ˆ', top: isAwayFirst,
          score: { away:0, home:0 },
          bso: { b:0, s:0, o:0 },
          runner: { b1:false, b2:false, b3:false },
          lineups: { away: getLineup('a'), home: getLineup('h') },
          pitchers: { away:{name:'ì›ì •íˆ¬ìˆ˜',total:0,s:0,b:0}, home:{name:'í™ˆíˆ¬ìˆ˜',total:0,s:0,b:0} },
          idx: { away:0, home:0 },
          lastPlay: ''
        };
        sync();
        document.getElementById('setupView').style.display='none';
        document.getElementById('gameView').style.display='block';
      };
    });

    // 1. íˆ¬êµ¬ ì¹´ìš´íŠ¸
    window.addBallCount = (type) => {
      const def = game.top ? 'home' : 'away';
      const pit = game.pitchers[def];
      pit.total++;

      if(type==='b') {
        game.bso.b++; pit.b++; game.lastPlay="ë³¼ ğŸŸ¢";
        if(game.bso.b>=4) openScenario('4ball', 'bb'); 
      } else if(type==='s') {
        game.bso.s++; pit.s++; game.lastPlay="ìŠ¤íŠ¸ë¼ì´í¬ ğŸŸ¡";
        if(game.bso.s>=3) openScenario('k', 'so'); 
      } else if(type==='f') {
        if(game.bso.s<2) game.bso.s++;
        pit.s++; game.lastPlay="íŒŒìš¸ ğŸ”´";
      }
      sync();
    };
    
    window.resetBSO = () => { game.bso = {b:0, s:0, o:game.bso.o}; game.lastPlay="ë¦¬ì…‹"; sync(); };

    // 2. ì‹œë‚˜ë¦¬ì˜¤ ëª¨ë‹¬
    window.openScenario = (type, detail) => {
      document.getElementById('scenarioModal').style.display = 'flex';
      tempScenario = { type, detail, runs: 0, runners: [game.runner.b1, game.runner.b2, game.runner.b3], loc: 'ì¤‘ì „' };
      document.getElementById('hitLocBox').style.display = (type==='hit' || type==='err') ? 'flex' : 'none';
      
      if(detail === 4) { 
         let r = 1; if(game.runner.b1) r++; if(game.runner.b2) r++; if(game.runner.b3) r++;
         tempScenario.runs = r;
         tempScenario.runners = [false, false, false];
      }
      updateModalUI();
    };

    function updateModalUI() {
      document.getElementById('scoreInput').textContent = tempScenario.runs;
      document.getElementById('chk1').className = 'base-chk bc-1 ' + (tempScenario.runners[0]?'checked':'');
      document.getElementById('chk2').className = 'base-chk bc-2 ' + (tempScenario.runners[1]?'checked':'');
      document.getElementById('chk3').className = 'base-chk bc-3 ' + (tempScenario.runners[2]?'checked':'');
    }

    window.toggleBase = (b) => { tempScenario.runners[b-1] = !tempScenario.runners[b-1]; updateModalUI(); };
    window.adjScore = (n) => { tempScenario.runs += n; if(tempScenario.runs < 0) tempScenario.runs=0; updateModalUI(); };
    window.selLoc = (btn, loc) => {
      document.querySelectorAll('.opt-btn').forEach(b=>b.classList.remove('selected'));
      btn.classList.add('selected');
      tempScenario.loc = loc;
    };
    window.closeScenario = () => document.getElementById('scenarioModal').style.display='none';

    // 3. ì „ì†¡
    window.submitScenario = () => {
      const atk = game.top ? 'away' : 'home';
      const def = game.top ? 'home' : 'away';
      const batter = game.lineups[atk][game.idx[atk]];
      const type = tempScenario.type;
      
      batter.pa++;
      if(type==='hit' || type==='hr' || type==='out' || type==='err' || type==='etc') batter.ab++;
      if(type==='hit' || type==='hr') batter.h++;
      if(type==='4ball') batter.bb++;
      if(type==='k') { batter.k++; batter.ab++; } 
      
      batter.rbi += tempScenario.runs;
      if(tempScenario.runs>0) {
         if(game.top) game.score.away += tempScenario.runs; else game.score.home += tempScenario.runs;
      }

      game.runner.b1 = tempScenario.runners[0];
      game.runner.b2 = tempScenario.runners[1];
      game.runner.b3 = tempScenario.runners[2];

      if(type === 'out' || type === 'k') game.bso.o++;
      
      let resTxt = "";
      if(type==='hit') resTxt = `${tempScenario.loc} ì•ˆíƒ€`;
      else if(tempScenario.detail===2) resTxt = `${tempScenario.loc} 2ë£¨íƒ€`;
      else if(tempScenario.detail===3) resTxt = `${tempScenario.loc} 3ë£¨íƒ€`;
      else if(tempScenario.detail===4) resTxt = "í™ˆëŸ°!!!";
      else if(type==='k') resTxt = "ì‚¼ì§„ ì•„ì›ƒ";
      else if(type==='4ball') resTxt = "ì‚¬ì‚¬êµ¬ ì¶œë£¨";
      else if(type==='out') resTxt = "ë²”íƒ€ ì•„ì›ƒ";
      else if(type==='err') resTxt = "ì‹¤ì±…";
      else if(type==='etc') resTxt = "ì•¼ìˆ˜ì„ íƒ/ê¸°íƒ€";
      
      if(tempScenario.runs > 0) resTxt += ` (+${tempScenario.runs}ì )`;
      
      log(`[${game.idx[atk]+1}ë²ˆ ${batter.name}] ${resTxt}`);
      game.lastPlay = resTxt; 

      if(game.bso.o >= 3) {
         alert("3ì•„ì›ƒ! ê³µìˆ˜êµëŒ€");
         game.idx[atk] = (game.idx[atk] + 1) % 9; 
         changeInning();
      } else {
         game.idx[atk] = (game.idx[atk] + 1) % 9;
         game.bso.b = 0; game.bso.s = 0;
      }

      sync();
      closeScenario();
    };

    function changeInning() {
      let n = parseInt(game.inn);
      if(game.top) { game.inn = n + 'íšŒë§'; game.top = false; }
      else { game.inn = (n + 1) + 'íšŒì´ˆ'; game.top = true; }
      game.bso = { b:0, s:0, o:0 };
      game.runner = { b1:false, b2:false, b3:false };
      log(`=== ${game.inn} ì‹œì‘ ===`);
    }

    async function sync() { await update(ref(db, 'status'), game); render(); }
    function log(msg) { push(ref(db, 'logs'), { text: msg, time: new Date().toLocaleTimeString('ko-KR',{hour:'2-digit',minute:'2-digit'}), notice: false }); }
    
    function render() {
       document.getElementById('d_away').textContent = game.teams.away;
       document.getElementById('d_home').textContent = game.teams.home;
       document.getElementById('s_away').textContent = game.score.away;
       document.getElementById('s_home').textContent = game.score.home;
       document.getElementById('d_inn').textContent = game.inn;
       
       document.getElementById('cnt_b').textContent = game.bso.b;
       document.getElementById('cnt_s').textContent = game.bso.s;
       document.getElementById('cnt_o').textContent = game.bso.o;
       
       const def = game.top ? 'home' : 'away';
       const pit = game.pitchers[def];
       document.getElementById('cur_pit').textContent = pit.name;
       document.getElementById('pit_t').textContent = pit.total;
       document.getElementById('pit_s').textContent = pit.s;
       document.getElementById('pit_b').textContent = pit.b;

       const atk = game.top ? 'away' : 'home';
       const bat = game.lineups[atk][game.idx[atk]];
       document.getElementById('cur_bat').textContent = `${game.idx[atk]+1}ë²ˆ ${bat.name}`;
    }
    
    onValue(ref(db, 'status'), (snap) => {
       if(snap.val()) { game = snap.val(); render(); 
       if(document.getElementById('setupView').style.display!=='none') {
          document.getElementById('setupView').style.display='none'; document.getElementById('gameView').style.display='block'; 
       }}
    });
    
    window.changeBatter = () => { const atk=game.top?'away':'home'; const n=prompt('ëŒ€íƒ€ ì´ë¦„'); if(n){game.lineups[atk][game.idx[atk]].name=n; log(`ëŒ€íƒ€ ${n}`); sync();} };
    window.changePitcher = () => { const def=game.top?'home':'away'; const n=prompt('íˆ¬ìˆ˜ ì´ë¦„'); if(n){game.pitchers[def]={name:n,total:0,s:0,b:0}; log(`íˆ¬ìˆ˜êµì²´ ${n}`); sync();} };
    window.endGame = () => {
       // ê²½ê¸° ì¢…ë£Œ ì‹œ ê²°ê³¼ë¥¼ json í˜•íƒœë¡œ ë§Œë“¤ì–´ì¤Œ (ë³µì‚¬í•´ì„œ schedule.jsonì— ë¶™ì—¬ë„£ê¸°ìš©)
       const res = { date: new Date().toLocaleDateString(), opponent: game.teams.home==='TAURUS'?game.teams.away:game.teams.home, score:`${game.score.away}:${game.score.home}`, result:'ì¢…ë£Œ' };
       prompt("ì´ ë‚´ìš©ì„ ë³µì‚¬í•´ì„œ schedule.json íŒŒì¼ì„ ìˆ˜ì •í•˜ì„¸ìš”:", JSON.stringify(res));
    };
  </script>
</body>
</html>